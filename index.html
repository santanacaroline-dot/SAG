<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SAG 2.1 - Sistema de An√°lise de Pareceres</title>
<style>
  * { margin:0; padding:0; box-sizing:border-box; font-family: "Segoe UI", sans-serif; }

  :root {
    --gradient-start: #4f8ef7;
    --gradient-end: #38b000;
    --primary-blue: #4f8ef7;
    --primary-green: #38b000;
    --white: #ffffff;
    --gray-bg: #f4f6f8;
    --text-dark: #333;
  }

  body, html { height:100%; background: var(--gray-bg); }
  
  #dashboard{padding: 2rem; max-width: 900px;margin: auto;}
  .section {background: #fff; padding: 1.5rem; margin-bottom: 1.2rem; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);}

  h1 { color: var(--primary-blue); margin-bottom: 1rem;}
  h2 {margin-bottom: 0.5rem;}

  textarea {width: 100%; min-height: 150px; resize: vertical; border: 1px solid #ccc; border-radius: 8px; padding: 0.8rem; font-family: "Segoe UI", sans-serif; font-size: 1rem; }

  button {background: var(--primary-blue); color: #fff;
  padding: 0.8rem 1.2rem; border: none; border-radius: 6px;
  margin-top: 0.8rem; cursor: pointer; font-weight: bold;}

  button:hover { background: #356cd1; }

  #analysisResult { background: #fff; border: 1px solid #ddd; padding: 1rem;
  border-radius: 10px; margin-top: 1rem; display: none;}

  /* SPLASH */
  #splash {
    position:fixed; inset:0;
    display:flex; align-items:center; justify-content:center;
    background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
    color:#fff; font-size:2.5em; font-weight:600; letter-spacing:1px;
  }

  /* CONTAINER */
  .container {
    display:none;
    min-height:100vh;
    align-items:center; justify-content:center;
    background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
  }

  form {
    background:#fff; padding:2rem; border-radius:12px;
    box-shadow:0 4px 15px rgba(0,0,0,0.15);
    width:90%; max-width:400px;
  }

  h2 { color: var(--primary-blue); text-align:center; margin-bottom:1rem; }

  label { display:block; margin-top:0.8rem; margin-bottom:0.3rem; font-weight:600; color:#444; }
  input[type="text"], input[type="email"], input[type="password"] {
    width:100%; padding:0.6rem; border:1px solid #ccc; border-radius:6px;
  }

  button {
    width:100%; padding:0.8rem; margin-top:1rem;
    border:none; border-radius:6px; font-weight:bold;
    cursor:pointer; transition:0.3s;
  }

  .btn-login { background: var(--primary-green); color: var(--white); }
  .btn-login:hover { background: #2e7d00; }
  .btn-blue { background: var(--primary-blue); color: var(--white); }
  .btn-blue:hover { background:#356cd1; }

  .link { color: var(--primary-blue); cursor:pointer; font-size:0.9rem; text-decoration:underline; }
  .flex-between { display:flex; justify-content:space-between; margin-top:0.5rem; }

  /* DASHBOARD */
  #dashboard { display:none; padding:2rem; }
  #dashboard h1 { color: var(--primary-blue); margin-bottom:1.5rem; }
  .section { background:#fff; padding:1.2rem; margin-bottom:1rem; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.08); }

  .section h2 { margin-bottom:0.5rem; color:var(--text-dark); }

  /* TEXTAREA PERSONALIZADO */
  textarea {
    width:100%; min-height:150px; resize:vertical;
    border:1px solid #ccc; border-radius:8px; padding:0.8rem;
    font-family: "Segoe UI", sans-serif; font-size:1rem;
    transition: all 0.3s ease;
  }
  textarea:focus {
    outline:none; border-color: var(--primary-blue);
    box-shadow: 0 0 6px rgba(79,142,247,0.4);
  }

  /* RESULTADO */
  #analysisResult {
    display:none;
    background:#fefefe; border:1px solid #ddd; padding:1rem;
    border-radius:10px; margin-top:1rem; line-height:1.5;
  }

  /* ALERTAS */
  .alert {
    background:#e8f5e9; color:#2e7d32; border:1px solid #81c784;
    padding:0.8rem; border-radius:6px; margin-bottom:1rem; display:none;
  }
  .alert.error { background:#ffebee; color:#c62828; border:1px solid #ef5350; }

  /* LOADER */
  .loader {
    border: 4px solid #f3f3f3;
    border-top: 4px solid var(--primary-blue);
    border-radius: 50%;
    width: 30px; height: 30px;
    animation: spin 1s linear infinite;
    margin: 1rem auto;
  }
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
</style>
</head>
<body>

<!-- SPLASH -->
<div id="splash">Bem-vindo(a) ao SAG 2.1</div>

<!-- LOGIN -->
<div id="login" class="container">
  <form id="loginForm">
    <h2>Login</h2>
    <div class="alert error" id="loginAlert">Email ou senha incorretos.</div>
    <label>Email</label>
    <input type="email" id="loginEmail" required>
    <label>Senha</label>
    <input type="password" id="loginPassword" required>
    <button type="submit" class="btn-login">Entrar</button>
    <div class="flex-between">
      <span class="link" onclick="showRegister()">N√£o sou cadastrado</span>
      <span class="link">Esqueci minha senha</span>
    </div>
  </form>
</div>

<!-- REGISTER -->
<div id="register" class="container">
  <form id="registerForm">
    <h2>Cadastro</h2>
    <div class="alert error" id="regAlert"></div>
    <label>Nome de Usu√°rio</label>
    <input type="text" id="username" required>
    <label>Email</label>
    <input type="email" id="regEmail" required>
    <label>Senha</label>
    <input type="password" id="regPassword" required>
    <label>Confirmar Senha</label>
    <input type="password" id="regConfirmPassword" required>
    <button type="submit" class="btn-login">Registrar</button>
    <div class="flex-between">
      <span class="link" onclick="showLogin()">J√° sou cadastrado</span>
    </div>
  </form>
</div>

<!-- DASHBOARD -->
<div id="dashboard">
  <h1>üìä Painel do SAG 2.1</h1>

  <div class="section">
    <h2>üßæ Inserir ou colar o Parecer</h2>
    <textarea id="parecerText" placeholder="Cole ou digite o texto do parecer aqui..."></textarea>
    <button onclick="analyzeText()">Analisar Parecer</button>

    <div id="loading" style="display:none">
      <div class="loader"></div>
      <p style="text-align:center; color:#555; margin-top:0.5rem;">Analisando texto...</p>
    </div>

    <div id="analysisResult"></div>
  </div>

  <div class="section">
    <h2>üö™ Encerrar Sess√£o</h2>
    <button class="btn-login" onclick="logout()">Sair</button>
  </div>
</div>

<script>
  async function analyzeText() {
    const text = document.getElementById('parecerText').value.trim();
    const resultDiv = document.getElementById('analysisResult');
    const loader = document.getElementById('loading');

    if (!text) {
      alert("Por favor, insira ou cole o texto do parecer.");
      return;
    }

    resultDiv.style.display = 'none';
    loader.style.display = 'block';

    try {
     const response = await fetch("http://127.0.0.1:5000/analyze",{
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ text })
     });

     const data = await response.json();

      loader.style.display = 'none';
      resultDiv.style.display = 'block';
      resultDiv.innerHTML = `<h3>üìã Relat√≥rio de An√°lise Automatizada</h3><p>${data.analysis}</p>`;
    } catch (error) {
      loader.style.display = 'none';
      alert("Erro ao conectar com o servidor de IA.");
      console.error(error);  
    }
  }
  // SPLASH
  setTimeout(() => {
    document.getElementById('splash').style.display = 'none';
    document.getElementById('login').style.display = 'flex';
  }, 3000);

  function showRegister() {
    document.getElementById('login').style.display = 'none';
    document.getElementById('register').style.display = 'flex';
  }

  function showLogin() {
    document.getElementById('register').style.display = 'none';
    document.getElementById('login').style.display = 'flex';
  }

  function showDashboard() {
    document.getElementById('login').style.display = 'none';
    document.getElementById('register').style.display = 'none';
    document.getElementById('dashboard').style.display = 'block';
  }

  // REGISTRO
  document.getElementById('registerForm').addEventListener('submit', function(e){
    e.preventDefault();
    const username = document.getElementById('username').value;
    const email = document.getElementById('regEmail').value;
    const password = document.getElementById('regPassword').value;
    const confirm = document.getElementById('regConfirmPassword').value;
    const alertBox = document.getElementById('regAlert');

    if(password !== confirm){
      alertBox.textContent = "‚ùå As senhas n√£o conferem!";
      alertBox.style.display = 'block';
      return;
    }

    let users = JSON.parse(localStorage.getItem('users')) || [];
    if(users.some(u => u.email === email)){
      alertBox.textContent = "‚ö†Ô∏è Este email j√° est√° cadastrado!";
      alertBox.style.display = 'block';
      return;
    }

    users.push({ username, email, password });
    localStorage.setItem('users', JSON.stringify(users));
    alert("‚úÖ Cadastro realizado com sucesso!");
    showLogin();
  });

  // LOGIN
  document.getElementById('loginForm').addEventListener('submit', function(e){
    e.preventDefault();
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    const users = JSON.parse(localStorage.getItem('users')) || [];
    const alertBox = document.getElementById('loginAlert');

    const user = users.find(u => u.email === email && u.password === password);
    if(user){
      localStorage.setItem('loggedUser', JSON.stringify(user));
      showDashboard();
    } else {
      alertBox.style.display = 'block';
    }
  });

  // LOGOUT
  function logout(){
    localStorage.removeItem('loggedUser');
    document.getElementById('dashboard').style.display = 'none';
    document.getElementById('login').style.display = 'flex';
  }

  // SIMULA√á√ÉO DE AN√ÅLISE DE TEXTO
  function analyzeText(){
    const text = document.getElementById('parecerText').value.trim();
    const resultDiv = document.getElementById('analysisResult');
    const loader = document.getElementById('loading');

    if(!text){
      alert("Por favor, insira ou cole o texto do parecer.");
      return;
    }

    // Mostra loader
    resultDiv.style.display = 'none';
    loader.style.display = 'block';

    // Simula tempo de "an√°lise"
    setTimeout(() => {
      loader.style.display = 'none';
      resultDiv.style.display = 'block';
      resultDiv.innerHTML = `
        <h3>üìã Relat√≥rio de An√°lise Automatizada</h3>
        <p><b>Resumo:</b> O parecer analisado cont√©m ${text.split(" ").length} palavras e aborda quest√µes t√©cnicas e interpretativas relevantes.</p>
        <p><b>Pontos Cr√≠ticos:</b> Foram identificadas poss√≠veis ambiguidades jur√≠dicas e falta de fundamenta√ß√£o em alguns trechos.</p>
        <p><b>Sugest√µes:</b> Recomenda-se revis√£o do embasamento legal e refor√ßo da argumenta√ß√£o em rela√ß√£o aos precedentes citados.</p>
        <p><b>Conclus√£o:</b> O parecer apresenta boa estrutura geral, mas pode ser aprimorado em clareza e consist√™ncia t√©cnica.</p>
        <hr>
        <p style="color:#888; font-size:0.9rem;">‚öôÔ∏è Esta √© uma an√°lise simulada. Para integra√ß√£o com IA real, conecte uma API de linguagem natural (ex: GPT).</p>
      `;
    }, 2000);
  }
</script>
</body>
</html>
